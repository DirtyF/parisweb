{"version":3,"sources":["auto-reload.js","app.js"],"names":["WebSocket","window","MozWebSocket","br","brunch","ar","disabled","cacheBuster","url","date","Math","round","Date","now","toString","replace","indexOf","browser","navigator","userAgent","toLowerCase","forceRepaint","reloaders","page","location","reload","stylesheet","slice","call","document","querySelectorAll","filter","link","val","getAttribute","href","forEach","setTimeout","body","offsetHeight","port","host","server","hostname","connect","connection","onmessage","event","message","data","reloader","onerror","readyState","close","onclose","Search","init","search","instantsearch","appId","apiKey","indexName","urlSync","searchFunction","helper","lazyloadCounter","showMoreTemplates","inactive","active","on","onRender","addSearchBoxWidget","addStatsWidget","addTagsWidget","addAuthorsWidget","addTypeWidget","addYearWidget","addHitsWidget","addPaginationWidget","start","hits","$","onVisible","hit","addClass","_","each","inViewport","offset","isRefined","facetName","facetValue","facetRefinements","getRefinements","find","value","cloudinary","options","baseUrl","stringOptions","width","push","height","quality","crop","radius","format","colorize","grayscale","color","gravity","join","transformItem","undefined","isConference","type","isWorkshop","description","_snippetResult","video","get","slides","thumbnail","startsWith","thumbnailLink","authors","map","author","index","picture","plainName","name","highlightedName","_highlightResult","tags","tag","plainValue","highlightedValue","displayData","uuid","objectID","title","getHighlightedValue","year","object","property","has","addWidget","widgets","searchBox","container","placeholder","stats","refinementList","attributeName","operator","limit","showMore","templates","sortBy","rangeSlider","tooltips","parseInt","pips","step","hitTemplate","html","noResults","hitsPerPage","item","empty","transformData","hitContainer","target","currentTarget","toggleRefinement","toggleClass","pagination","labels","previous","next","showFirstLast","addCurrentRefinedValues","currentRefinedValues","clearAll"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA,CAAC,YAAW;AACV,MAAIA,YAAYC,OAAOD,SAAP,IAAoBC,OAAOC,YAA3C;AACA,MAAIC,KAAKF,OAAOG,MAAP,GAAiBH,OAAOG,MAAP,IAAiB,EAA3C;AACA,MAAIC,KAAKF,GAAG,aAAH,IAAqBA,GAAG,aAAH,KAAqB,EAAnD;AACA,MAAI,CAACH,SAAD,IAAcK,GAAGC,QAArB,EAA+B;;AAE/B,MAAIC,cAAc,SAAdA,WAAc,CAASC,GAAT,EAAa;AAC7B,QAAIC,OAAOC,KAAKC,KAAL,CAAWC,KAAKC,GAAL,KAAa,IAAxB,EAA8BC,QAA9B,EAAX;AACAN,UAAMA,IAAIO,OAAJ,CAAY,yBAAZ,EAAuC,EAAvC,CAAN;AACA,WAAOP,OAAOA,IAAIQ,OAAJ,CAAY,GAAZ,KAAoB,CAApB,GAAwB,GAAxB,GAA8B,GAArC,IAA2C,cAA3C,GAA4DP,IAAnE;AACD,GAJD;;AAMA,MAAIQ,UAAUC,UAAUC,SAAV,CAAoBC,WAApB,EAAd;AACA,MAAIC,eAAehB,GAAGgB,YAAH,IAAmBJ,QAAQD,OAAR,CAAgB,QAAhB,IAA4B,CAAC,CAAnE;;AAEA,MAAIM,YAAY;AACdC,UAAM,gBAAU;AACdtB,aAAOuB,QAAP,CAAgBC,MAAhB,CAAuB,IAAvB;AACD,KAHa;;AAKdC,gBAAY,sBAAU;AACpB,SAAGC,KAAH,CACGC,IADH,CACQC,SAASC,gBAAT,CAA0B,sBAA1B,CADR,EAEGC,MAFH,CAEU,UAASC,IAAT,EAAe;AACrB,YAAIC,MAAMD,KAAKE,YAAL,CAAkB,iBAAlB,CAAV;AACA,eAAOF,KAAKG,IAAL,IAAaF,OAAO,OAA3B;AACD,OALH,EAMGG,OANH,CAMW,UAASJ,IAAT,EAAe;AACtBA,aAAKG,IAAL,GAAY5B,YAAYyB,KAAKG,IAAjB,CAAZ;AACD,OARH;;AAUA;AACA,UAAId,YAAJ,EAAkBgB,WAAW,YAAW;AAAER,iBAASS,IAAT,CAAcC,YAAd;AAA6B,OAArD,EAAuD,EAAvD;AACnB;AAlBa,GAAhB;AAoBA,MAAIC,OAAOnC,GAAGmC,IAAH,IAAW,IAAtB;AACA,MAAIC,OAAOtC,GAAGuC,MAAH,IAAazC,OAAOuB,QAAP,CAAgBmB,QAA7B,IAAyC,WAApD;;AAEA,MAAIC,UAAU,SAAVA,OAAU,GAAU;AACtB,QAAIC,aAAa,IAAI7C,SAAJ,CAAc,UAAUyC,IAAV,GAAiB,GAAjB,GAAuBD,IAArC,CAAjB;AACAK,eAAWC,SAAX,GAAuB,UAASC,KAAT,EAAe;AACpC,UAAI1C,GAAGC,QAAP,EAAiB;AACjB,UAAI0C,UAAUD,MAAME,IAApB;AACA,UAAIC,WAAW5B,UAAU0B,OAAV,KAAsB1B,UAAUC,IAA/C;AACA2B;AACD,KALD;AAMAL,eAAWM,OAAX,GAAqB,YAAU;AAC7B,UAAIN,WAAWO,UAAf,EAA2BP,WAAWQ,KAAX;AAC5B,KAFD;AAGAR,eAAWS,OAAX,GAAqB,YAAU;AAC7BrD,aAAOoC,UAAP,CAAkBO,OAAlB,EAA2B,IAA3B;AACD,KAFD;AAGD,GAdD;AAeAA;AACD,CAtDD;AAuDA;;;;;;;ACxDA,IAAIW,SAAS;AACXC,MADW,kBACJ;AACL,SAAKC,MAAL,GAAcC,cAAc;AAC1BC,aAAO,YADmB;AAE1BC,cAAQ,kCAFkB;AAG1BC,iBAAW,UAHe;AAI1BC,eAAS,IAJiB;AAK1BC,sBAAgB,wBAACC,MAAD,EAAY;AAC1B;AACAT,eAAOU,eAAP,GAAyB,CAAzB;AACAD,eAAOP,MAAP;AACD;AATyB,KAAd,CAAd;;AAYA,SAAKS,iBAAL,GAAyB;AACvBC,gBAAS,gEADc;AAEvBC,cAAO;AAFgB,KAAzB;;AAKA,SAAKX,MAAL,CAAYY,EAAZ,CAAe,QAAf,EAAyB,KAAKC,QAA9B;;AAEA,SAAKC,kBAAL;AACA,SAAKC,cAAL;AACA,SAAKC,aAAL;AACA,SAAKC,gBAAL;AACA,SAAKC,aAAL;AACA,SAAKC,aAAL;AACA,SAAKC,aAAL;AACA,SAAKC,mBAAL;AACA;;AAEA,SAAKrB,MAAL,CAAYsB,KAAZ;AACD,GAhCU;AAiCXT,UAjCW,sBAiCA;AACT;AACA,QAAIU,OAAOC,EAAE,MAAF,CAAX;AACA,aAASC,SAAT,CAAmBC,GAAnB,EAAwB;AACtBF,QAAEE,GAAF,EAAOC,QAAP,CAAgB,iBAAhB;AACD;AACDC,MAAEC,IAAF,CAAON,IAAP,EAAa,UAACG,GAAD,EAAS;AACpBI,iBAAWJ,GAAX,EAAgB,EAACK,QAAQ,EAAT,EAAhB,EAA8BN,SAA9B;AACD,KAFD;AAGD,GA1CU;;AA2CX;AACAO,WA5CW,qBA4CDC,SA5CC,EA4CUC,UA5CV,EA4CsB;AAC/B,QAAIC,mBAAmBrC,OAAOE,MAAP,CAAcO,MAAd,CAAqB6B,cAArB,CAAoCH,SAApC,CAAvB;AACA,WAAO,CAAC,CAACL,EAAES,IAAF,CAAOF,gBAAP,EAAyB,EAAEG,OAAOJ,UAAT,EAAzB,CAAT;AACD,GA/CU;AAgDXK,YAhDW,sBAgDAxF,GAhDA,EAgDKyF,OAhDL,EAgDc;AACvB,QAAIC,UAAU,6DAAd;AACA,QAAIC,gBAAgB,EAApB;;AAEA;AACA,QAAIF,QAAQG,KAAZ,EAAmB;AACjBD,oBAAcE,IAAd,QAAwBJ,QAAQG,KAAhC;AACD;AACD,QAAIH,QAAQK,MAAZ,EAAoB;AAClBH,oBAAcE,IAAd,QAAwBJ,QAAQK,MAAhC;AACD;AACD,QAAIL,QAAQM,OAAZ,EAAqB;AACnBJ,oBAAcE,IAAd,QAAwBJ,QAAQM,OAAhC;AACD;AACD,QAAIN,QAAQO,IAAZ,EAAkB;AAChBL,oBAAcE,IAAd,QAAwBJ,QAAQO,IAAhC;AACD;AACD,QAAIP,QAAQQ,MAAZ,EAAoB;AAClBN,oBAAcE,IAAd,QAAwBJ,QAAQQ,MAAhC;AACD;AACD,QAAIR,QAAQS,MAAZ,EAAoB;AAClBP,oBAAcE,IAAd,QAAwBJ,QAAQS,MAAhC;AACD;AACD,QAAIT,QAAQU,QAAZ,EAAsB;AACpBR,oBAAcE,IAAd,iBAAiCJ,QAAQU,QAAzC;AACD;AACD,QAAIV,QAAQW,SAAZ,EAAuB;AACrBT,oBAAcE,IAAd;AACD;AACD,QAAIJ,QAAQY,KAAZ,EAAmB;AACjBV,oBAAcE,IAAd,aAA6BJ,QAAQY,KAArC;AACD;AACD,QAAIZ,QAAQa,OAAZ,EAAqB;AACnBX,oBAAcE,IAAd,QAAwBJ,QAAQa,OAAhC;AACD;;AAED;AACAtG,UAAMA,IAAIO,OAAJ,CAAY,OAAZ,EAAqB,SAArB,CAAN;;AAEA,gBAAUmF,OAAV,GAAoBC,cAAcY,IAAd,CAAmB,GAAnB,CAApB,SAA+CvG,GAA/C;AACD,GAxFU;AAyFXwG,eAzFW,yBAyFG/D,IAzFH,EAyFS;AAClB;AACA;AACA,QAAIsC,aAAa,KAAjB;AACA,QAAIhC,OAAOU,eAAP,KAA2BgD,SAA3B,IAAwC1D,OAAOU,eAAP,GAAyB,CAArE,EAAwE;AACtEsB,mBAAa,IAAb;AACD;AACDhC,WAAOU,eAAP;;AAEA;AACA,QAAIiD,eAAejE,KAAKkE,IAAL,IAAa,YAAhC;AACA,QAAIC,aAAanE,KAAKkE,IAAL,IAAa,SAA9B;;AAEA;AACA,QAAIE,cAAcpE,KAAKqE,cAAL,CAAoBD,WAApB,CAAgCtB,KAAlD;AACAsB,kBAAcA,YAAYtG,OAAZ,CAAoB,IAApB,EAA0B,GAA1B,CAAd;;AAEA;AACA,QAAIwG,QAAQlC,EAAEmC,GAAF,CAAMvE,IAAN,EAAY,kBAAZ,CAAZ;AACA,QAAIwE,SAASpC,EAAEmC,GAAF,CAAMvE,IAAN,EAAY,mBAAZ,CAAb;;AAEA;AACA,QAAIyE,YAAYzE,KAAKyE,SAArB;AACA,QAAIA,SAAJ,EAAe;AACb,UAAIrC,EAAEsC,UAAF,CAAaD,SAAb,EAAwB,OAAxB,CAAJ,EAAsC;AACpCA,+DAAqDA,SAArD;AACD;AACDA,kBAAYnE,OAAOyC,UAAP,CAAkB0B,SAAlB,EAA6B;AACvCnB,iBAAS,EAD8B;AAEvCG,gBAAQ;AAF+B,OAA7B,CAAZ;AAID;AACD,QAAIkB,gBAAgBL,SAASE,MAA7B;;AAEA;AACA,QAAII,UAAUxC,EAAEyC,GAAF,CAAM7E,KAAK4E,OAAX,EAAoB,UAACE,MAAD,EAASC,KAAT,EAAmB;AACnD,UAAIC,UAAU1E,OAAOyC,UAAP,CAAkB+B,OAAOE,OAAzB,EAAkC;AAC9C3B,gBAAQ,EADsC;AAE9CF,eAAO,EAFuC;AAG9CG,iBAAS,EAHqC;AAI9CK,mBAAW,IAJmC;AAK9CJ,cAAM,OALwC;AAM9CC,gBAAQ,KANsC;AAO9CC,gBAAQ;AAPsC,OAAlC,CAAd;AASA,aAAO;AACLwB,mBAAWH,OAAOI,IADb;AAELC,yBAAiBnF,KAAKoF,gBAAL,CAAsBR,OAAtB,CAA8BG,KAA9B,EAAqCG,IAArC,CAA0CpC,KAFtD;AAGLN,mBAAWlC,OAAOkC,SAAP,CAAiB,cAAjB,EAAiCsC,OAAOI,IAAxC,CAHN;AAILF;AAJK,OAAP;AAMD,KAhBa,CAAd;;AAkBA;AACA,QAAIK,OAAOjD,EAAEyC,GAAF,CAAM7E,KAAKqF,IAAX,EAAiB,UAACC,GAAD,EAAMP,KAAN,EAAgB;AAC1C,aAAO;AACLQ,oBAAYD,GADP;AAELE,0BAAkBxF,KAAKoF,gBAAL,CAAsBC,IAAtB,CAA2BN,KAA3B,EAAkCjC,KAF/C;AAGLN,mBAAWlC,OAAOkC,SAAP,CAAiB,MAAjB,EAAyB8C,GAAzB;AAHN,OAAP;AAKD,KANU,CAAX;;AAQA,QAAIG,cAAc;AAChBC,YAAM1F,KAAK2F,QADK;AAEhBrD,4BAFgB;AAGhB2B,gCAHgB;AAIhBE,4BAJgB;AAKhByB,aAAOtF,OAAOuF,mBAAP,CAA2B7F,IAA3B,EAAiC,OAAjC,CALS;AAMhBzC,WAAKyC,KAAKzC,GANM;AAOhB6G,8BAPgB;AAQhB0B,YAAM9F,KAAK8F,IARK;AAShBrB,0BATgB;AAUhBE,kCAVgB;AAWhBL,kBAXgB;AAYhBE,oBAZgB;AAahBa,gBAbgB;AAchBT,sBAdgB;AAehBe,gBAAU3F,KAAK2F;AAfC,KAAlB;;AAkBA,WAAOF,WAAP;AACD,GA1KU;AA2KXI,qBA3KW,+BA2KSE,MA3KT,EA2KiBC,QA3KjB,EA2K2B;AACpC,QAAI,CAAC5D,EAAE6D,GAAF,CAAMF,MAAN,wBAAkCC,QAAlC,YAAL,EAA0D;AACxD,aAAOD,OAAOC,QAAP,CAAP;AACD;AACD,WAAOD,OAAOX,gBAAP,CAAwBY,QAAxB,EAAkClD,KAAzC;AACD,GAhLU;AAiLXxB,oBAjLW,gCAiLU;AACnB,SAAKd,MAAL,CAAY0F,SAAZ,CACEzF,cAAc0F,OAAd,CAAsBC,SAAtB,CAAgC;AAC9BC,iBAAW,IADmB;AAE9BC,mBAAa;AAFiB,KAAhC,CADF;AAMD,GAxLU;AAyLX/E,gBAzLW,4BAyLM;AACf,SAAKf,MAAL,CAAY0F,SAAZ,CACEzF,cAAc0F,OAAd,CAAsBI,KAAtB,CAA4B;AAC1BF,iBAAW;AADe,KAA5B,CADF;AAKD,GA/LU;AAgMX7E,eAhMW,2BAgMK;AACd,SAAKhB,MAAL,CAAY0F,SAAZ,CACEzF,cAAc0F,OAAd,CAAsBK,cAAtB,CAAqC;AACnCH,iBAAW,OADwB;AAEnCI,qBAAe,MAFoB;AAGnCC,gBAAU,KAHyB;AAInCC,aAAO,EAJ4B;AAKnCC,gBAAU;AACRD,eAAO,EADC;AAERE,mBAAWvG,OAAOW;AAFV;AALyB,KAArC,CADF;AAYD,GA7MU;AA8MXQ,kBA9MW,8BA8MQ;AACjB,SAAKjB,MAAL,CAAY0F,SAAZ,CACEzF,cAAc0F,OAAd,CAAsBK,cAAtB,CAAqC;AACnCH,iBAAW,UADwB;AAEnCI,qBAAe,cAFoB;AAGnCC,gBAAU,IAHyB;AAInCI,cAAQ,CAAC,WAAD,EAAc,UAAd,EAA0B,YAA1B,CAJ2B;AAKnCH,aAAO,EAL4B;AAMnCC,gBAAU;AACRD,eAAO,EADC;AAERE,mBAAWvG,OAAOW;AAFV;AANyB,KAArC,CADF;AAaD,GA5NU;AA6NXS,eA7NW,2BA6NK;AACd,SAAKlB,MAAL,CAAY0F,SAAZ,CACEzF,cAAc0F,OAAd,CAAsBK,cAAtB,CAAqC;AACnCH,iBAAW,OADwB;AAEnCI,qBAAe;AAFoB,KAArC,CADF;AAMD,GApOU;AAqOX9E,eArOW,2BAqOK;AACd,SAAKnB,MAAL,CAAY0F,SAAZ,CACEzF,cAAc0F,OAAd,CAAsBY,WAAtB,CAAkC;AAChCV,iBAAW,OADqB;AAEhCI,qBAAe,MAFiB;AAGhCO,gBAAU;AACRvD,gBAAQrB,EAAE6E;AADF,OAHsB;AAMhCC,YAAM,KAN0B;AAOhCC,YAAM;AAP0B,KAAlC,CADF;AAWD,GAjPU;AAkPXvF,eAlPW,2BAkPK;AACd,QAAIwF,cAAcpF,EAAE,cAAF,EAAkBqF,IAAlB,EAAlB;AACA,QAAIC,YAAYtF,EAAE,YAAF,EAAgBqF,IAAhB,EAAhB;AACA,SAAK7G,MAAL,CAAY0F,SAAZ,CACEzF,cAAc0F,OAAd,CAAsBpE,IAAtB,CAA2B;AACzBsE,iBAAW,OADc;AAEzBkB,mBAAa,EAFY;AAGzBV,iBAAW;AACTW,cAAMJ,WADG;AAETK,eAAOH;AAFE,OAHc;AAOzBI,qBAAe;AACbF,cAAMlH,OAAOyD;AADA;AAPU,KAA3B,CADF;;AAcA;AACA,QAAI4D,eAAe3F,EAAE,OAAF,CAAnB;AACA2F,iBAAavG,EAAb,CAAgB,OAAhB,EAAyB,kBAAzB,EAA6C,UAACtB,KAAD,EAAW;AACtD,UAAI8H,SAAS5F,EAAElC,MAAM+H,aAAR,CAAb;AACA,UAAIpF,YAAYmF,OAAO5H,IAAP,CAAY,YAAZ,CAAhB;AACA,UAAI0C,aAAakF,OAAO5H,IAAP,CAAY,aAAZ,CAAjB;AACAM,aAAOE,MAAP,CAAcO,MAAd,CAAqB+G,gBAArB,CAAsCrF,SAAtC,EAAiDC,UAAjD,EAA6DlC,MAA7D;AACAoH,aAAOG,WAAP,CAAmB,sBAAnB;AACD,KAND;AAOD,GA5QU;AA6QXlG,qBA7QW,iCA6QW;AACpB,SAAKrB,MAAL,CAAY0F,SAAZ,CACEzF,cAAc0F,OAAd,CAAsB6B,UAAtB,CAAiC;AAC/B3B,iBAAW,aADoB;AAE/B4B,cAAQ;AACNC,kBAAU,YADJ;AAENC,cAAM;AAFA,OAFuB;AAM/BC,qBAAe;AANgB,KAAjC,CADF;AAUD,GAxRU;AAyRXC,yBAzRW,qCAyRe;AACxB,SAAK7H,MAAL,CAAY0F,SAAZ,CACEzF,cAAc0F,OAAd,CAAsBmC,oBAAtB,CAA2C;AACzCjC,iBAAW,yBAD8B;AAEzCkC,gBAAU;AAF+B,KAA3C,CADF;AAMD;AAhSU,CAAb;;kBAmSejI,M","file":"public/app.js","sourcesContent":["/* jshint ignore:start */\n(function() {\n  var WebSocket = window.WebSocket || window.MozWebSocket;\n  var br = window.brunch = (window.brunch || {});\n  var ar = br['auto-reload'] = (br['auto-reload'] || {});\n  if (!WebSocket || ar.disabled) return;\n\n  var cacheBuster = function(url){\n    var date = Math.round(Date.now() / 1000).toString();\n    url = url.replace(/(\\&|\\\\?)cacheBuster=\\d*/, '');\n    return url + (url.indexOf('?') >= 0 ? '&' : '?') +'cacheBuster=' + date;\n  };\n\n  var browser = navigator.userAgent.toLowerCase();\n  var forceRepaint = ar.forceRepaint || browser.indexOf('chrome') > -1;\n\n  var reloaders = {\n    page: function(){\n      window.location.reload(true);\n    },\n\n    stylesheet: function(){\n      [].slice\n        .call(document.querySelectorAll('link[rel=stylesheet]'))\n        .filter(function(link) {\n          var val = link.getAttribute('data-autoreload');\n          return link.href && val != 'false';\n        })\n        .forEach(function(link) {\n          link.href = cacheBuster(link.href);\n        });\n\n      // Hack to force page repaint after 25ms.\n      if (forceRepaint) setTimeout(function() { document.body.offsetHeight; }, 25);\n    }\n  };\n  var port = ar.port || 9486;\n  var host = br.server || window.location.hostname || 'localhost';\n\n  var connect = function(){\n    var connection = new WebSocket('ws://' + host + ':' + port);\n    connection.onmessage = function(event){\n      if (ar.disabled) return;\n      var message = event.data;\n      var reloader = reloaders[message] || reloaders.page;\n      reloader();\n    };\n    connection.onerror = function(){\n      if (connection.readyState) connection.close();\n    };\n    connection.onclose = function(){\n      window.setTimeout(connect, 1000);\n    };\n  };\n  connect();\n})();\n/* jshint ignore:end */","let Search = {\n  init() {\n    this.search = instantsearch({\n      appId: 'O3F8QXYK6R',\n      apiKey: 'cb3f3d3a43a5996e9f5ba74003462a4f',\n      indexName: 'parisweb',\n      urlSync: true,\n      searchFunction: (helper) => {\n        // Reset the lazyloadCounter\n        Search.lazyloadCounter = 0;\n        helper.search();\n      }\n    });\n\n    this.showMoreTemplates = {\n      inactive:'<a class=\"ais-show-more ais-show-more__inactive\">Voir plus</a>',\n      active:'<a class=\"ais-show-more ais-show-more__active\">Voir moins</a>'\n    }\n\n    this.search.on('render', this.onRender);\n\n    this.addSearchBoxWidget();\n    this.addStatsWidget();\n    this.addTagsWidget();\n    this.addAuthorsWidget();\n    this.addTypeWidget();\n    this.addYearWidget();\n    this.addHitsWidget();\n    this.addPaginationWidget();\n    // this.addCurrentRefinedValues();\n\n    this.search.start();\n  },\n  onRender() {\n    // Enable lazyloading of images below the fold\n    let hits = $('.hit');\n    function onVisible(hit) {\n      $(hit).addClass('hit__inViewport');\n    }\n    _.each(hits, (hit) => {\n      inViewport(hit, {offset: 50}, onVisible);\n    });\n  },\n  // Check if the specified facet value is currently refined\n  isRefined(facetName, facetValue) {\n    let facetRefinements = Search.search.helper.getRefinements(facetName);\n    return !!_.find(facetRefinements, { value: facetValue });\n  },\n  cloudinary(url, options) {\n    let baseUrl = 'https://res.cloudinary.com/pixelastic-parisweb/image/fetch/';\n    let stringOptions = [];\n\n    // Handle common Cloudinary options\n    if (options.width) {\n      stringOptions.push(`w_${options.width}`);\n    }\n    if (options.height) {\n      stringOptions.push(`h_${options.height}`);\n    }\n    if (options.quality) {\n      stringOptions.push(`q_${options.quality}`);\n    }\n    if (options.crop) {\n      stringOptions.push(`c_${options.crop}`);\n    }\n    if (options.radius) {\n      stringOptions.push(`r_${options.radius}`);\n    }\n    if (options.format) {\n      stringOptions.push(`f_${options.format}`);\n    }\n    if (options.colorize) {\n      stringOptions.push(`e_colorize:${options.colorize}`);\n    }\n    if (options.grayscale) {\n      stringOptions.push(`e_grayscale`);\n    }\n    if (options.color) {\n      stringOptions.push(`co_rgb:${options.color}`);\n    }\n    if (options.gravity) {\n      stringOptions.push(`g_${options.gravity}`);\n    }\n\n    // Fix remote urls\n    url = url.replace(/^\\/\\//, 'http://');\n\n    return `${baseUrl}${stringOptions.join(',')}/${url}`;\n  },\n  transformItem(data) {\n    // All items are defered loading their images until in viewport, except\n    // the 4 first\n    let inViewport = false;\n    if (Search.lazyloadCounter === undefined || Search.lazyloadCounter < 4) {\n      inViewport = true;\n    }\n    Search.lazyloadCounter++;\n\n    // Conference / Workshop\n    let isConference = data.type == 'Conférence';\n    let isWorkshop = data.type == 'Atelier';\n\n    // Description\n    let description = data._snippetResult.description.value;\n    description = description.replace(' …', '…');\n\n    // Ressources\n    let video = _.get(data, 'ressources.video');\n    let slides = _.get(data, 'ressources.slides');\n\n    // Thumbnail\n    let thumbnail = data.thumbnail;\n    if (thumbnail) {\n      if (_.startsWith(thumbnail, './img')) {\n        thumbnail = `https://pixelastic.github.io/parisweb/${thumbnail}`;\n      }\n      thumbnail = Search.cloudinary(thumbnail, {\n        quality: 90,\n        format: 'auto'\n      });\n    }\n    let thumbnailLink = video || slides;\n\n    // Authors\n    let authors = _.map(data.authors, (author, index) => {\n      let picture = Search.cloudinary(author.picture, {\n        height: 50,\n        width: 50,\n        quality: 90,\n        grayscale: true,\n        crop: 'scale',\n        radius: 'max',\n        format: 'auto'\n      });\n      return {\n        plainName: author.name,\n        highlightedName: data._highlightResult.authors[index].name.value,\n        isRefined: Search.isRefined('authors.name', author.name),\n        picture\n      }\n    });\n\n    // Tags\n    let tags = _.map(data.tags, (tag, index) => {\n      return {\n        plainValue: tag,\n        highlightedValue: data._highlightResult.tags[index].value,\n        isRefined: Search.isRefined('tags', tag),\n      }\n    });\n\n    let displayData = {\n      uuid: data.objectID,\n      inViewport,\n      isConference,\n      isWorkshop,\n      title: Search.getHighlightedValue(data, 'title'),\n      url: data.url,\n      description,\n      year: data.year,\n      thumbnail,\n      thumbnailLink,\n      video,\n      slides,\n      tags,\n      authors,\n      objectID: data.objectID\n    };\n\n    return displayData;\n  },\n  getHighlightedValue(object, property) {\n    if (!_.has(object, `_highlightResult.${property}.value`)) {\n      return object[property];\n    }\n    return object._highlightResult[property].value;\n  },\n  addSearchBoxWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.searchBox({\n        container: '#q',\n        placeholder: 'Rechercher une conférence, un orateur, un thème...'\n      })\n    );\n  },\n  addStatsWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.stats({\n        container: '#stats'\n      })\n    );\n  },\n  addTagsWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.refinementList({\n        container: '#tags',\n        attributeName: 'tags',\n        operator: 'and',\n        limit: 10,\n        showMore: {\n          limit: 20,\n          templates: Search.showMoreTemplates\n        }\n      })\n    );\n  },\n  addAuthorsWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.refinementList({\n        container: '#authors',\n        attributeName: 'authors.name',\n        operator: 'or',\n        sortBy: ['isRefined', 'name:asc', 'count:desc'],\n        limit: 10,\n        showMore: {\n          limit: 20,\n          templates: Search.showMoreTemplates\n        }\n      })\n    );\n  },\n  addTypeWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.refinementList({\n        container: '#type',\n        attributeName: 'type'\n      })\n    );\n  },\n  addYearWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.rangeSlider({\n        container: '#year',\n        attributeName: 'year',\n        tooltips: {\n          format: _.parseInt\n        },\n        pips: false,\n        step: 1\n      })\n    );\n  },\n  addHitsWidget() {\n    let hitTemplate = $('#hitTemplate').html();\n    let noResults = $('#noResults').html();\n    this.search.addWidget(\n      instantsearch.widgets.hits({\n        container: '#hits',\n        hitsPerPage: 10,\n        templates: {\n          item: hitTemplate,\n          empty: noResults\n        },\n        transformData: {\n          item: Search.transformItem\n        }\n      })\n    );\n\n    // Allow user to further select/deselect facets directly in the hits\n    let hitContainer = $('#hits');\n    hitContainer.on('click', '.js-facet-toggle', (event) => {\n      var target = $(event.currentTarget);\n      var facetName = target.data('facet-name');\n      var facetValue = target.data('facet-value');\n      Search.search.helper.toggleRefinement(facetName, facetValue).search();\n      target.toggleClass('hit-facet__isRefined');\n    });\n  },\n  addPaginationWidget() {\n    this.search.addWidget(\n      instantsearch.widgets.pagination({\n        container: '#pagination',\n        labels: {\n          previous: '‹ Previous',\n          next: 'Next ›'\n        },\n        showFirstLast: false\n      })\n    );\n  },\n  addCurrentRefinedValues() {\n    this.search.addWidget(\n      instantsearch.widgets.currentRefinedValues({\n        container: '#current-refined-values',\n        clearAll: 'before'\n      })\n    );\n  }\n};\n\nexport default Search;\n"]}